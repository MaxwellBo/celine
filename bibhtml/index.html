<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@celine/bibhtml</title>

  <meta name="description" content="A Web Components-based referencing system for HTML documents.">
  <meta name="author" content="Max Bo">
  <meta name="keywords" content="bibliography, citation, web components, html, javascript, citation.js">
  <meta name="robots" content="index, follow">

  <meta property="og:title" content="@celine/bibhtml">
  <meta property="og:description" content="A Web Components-based referencing system for HTML documents.">
  <meta property="og:url" content="https://maxbo.me/celine/bibhtml/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Max Bo">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@_max_bo_">
  <meta name="twitter:title" content="@celine/bibhtml">
  <meta name="twitter:description" content="A Web Components-based referencing system for HTML documents.">
  <meta name="twitter:card" content="summary_large_image">

  <meta name="theme-color" content="#ffffff">
  <link rel="apple-touch-icon" sizes="180x180" href="../static/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../static/favicon-16x16.png">
  <link rel="manifest" href="../static/site.webmanifest">

  <link rel="stylesheet" href="../libertine/libertine.css">
  <link rel="stylesheet" href="../celine/cell.css">

  <meta property="og:image" content="https://maxbo.me/celine/bibhtml/static/og.png">
  <meta name="twitter:image" content="https://maxbo.me/celine/bibhtml/static/og.png">
  <meta name="twitter:card" content="summary_large_image">

  <script type="module">
    import { CelineModule, registerScriptReevaluationOnBlur } from 'https://esm.sh/jsr/@celine/celine@3.0.0';
    import * as Inputs from 'https://esm.run/@observablehq/inputs@0.12.0';
    import * as htl from 'https://esm.run/htl@0.3.1';

    window.celine = CelineModule.usingNewObservableRuntimeAndModule(document);
    window.library = celine.library; /* @observablehq/stdlib */
    window.Inputs = Inputs;
    window.htl = htl;

    registerScriptReevaluationOnBlur(document, /*class=*/'echo');
  </script>
</head>

<body>
  <main>
  <div style="text-align: right; font-family: 'Libertinus Sans', sans-serif;">
    <a style="text-decoration: none;" href="../index.html">/celine</a>,
    <a style="text-decoration: none;" href="../libertine/index.html">/libertine</a>
  </div>
  <h1>@celine/bibhtml</h1>
  <div class="authors">
    <div class="author">
      <span class="author-name"><a href="https://maxbo.me">Max Bo</a></span> 
    </div>
  </div>

  <section class="abstract">
    <p>
      <cite>@celine/bibhtml</cite> is a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components">Web
        Components</a>-based referencing system for HTML documents. It aims to provide a similar user experience to
      referencing in LaTeX/BibTeX. It's a thin wrapper around <a
        href="https://citation.js.org/">Citation.js</a><sup><bh-cite><a href="#willighagen2019">[#?]</a></bh-cite></sup> and 
      gracefully degrades when citations and references are malformed or JavaScript is disabled. 
    </p>
    <p>
      <cite>@celine/bibhtml</cite> takes significant inspiration from <a href="https://github.com/citation-js/replacer">@citation-js/replacer</a>, <a
      href="https://lab.avl.la/references-webcomponent/">References Web Component</a><sup><bh-cite><a href="#avellar2021">[#?]</a></bh-cite></sup> and <a
      href="https://nota-lang.org/reference.html#def-section-2.4">Nota's
      citations</a><sup><bh-cite><a href="#crichton2021nota">[#?]</a></bh-cite></sup>.
    </p>
  </section>

  <table>
    <tbody>
      <tr>
        <th>GitHub</th>
        <td class="width-auto"><a href="https://github.com/MaxwellBo/celine/tree/master/bibhtml">MaxwellBo/<wbr>celine</a><span id="stars"></span> + <a href="https://github.com/MaxwellBo/celine/issues">/issues</a> </td> 
        <th class="width-min">License</th>
        <td><a href="https://github.com/MaxwellBo/celine/blob/master/LICENSE">MIT</a></td>
      </tr>
      <script type="module">
        // ping the GitHub API for the number of stars
        fetch("https://api.github.com/repos/MaxwellBo/celine")
          .then(d => d.json())
          .then(resp => {
            const stars = resp.stargazers_count;
            document.getElementById("stars").textContent = ` (‚≠ê ${stars})`;
          })
      </script>
      <tr>
        <th>JSR</th>
        <td class="width-auto"><a href="https://jsr.io/@celine/bibhtml">jsr.io/<wbr>@celine/<wbr>bibhtml</a> + <a href="https://jsr.io/@celine/bibhtml/doc">/docs</a></td>
        <th>Version</th>
        <td class="width-min"><a href="https://jsr.io/@celine/bibhtml/versions" id="version">1.2.0</a>, <time  id="updated">Nov 29 2024</time></td>
      </tr>
      <script type="module">
        fetch("https://npm.jsr.io/@jsr/celine__bibhtml")
          .then(d => d.json())
          .then(resp => {
            const latestVersion = resp["dist-tags"].latest;
            document.getElementById("version").textContent = latestVersion;
            const date = new Date(resp.time[latestVersion]);
            const formattedDate = `${date.toLocaleString('default', { month: 'short' })} ${date.getDate()} ${date.getFullYear()}`;
            document.getElementById("updated").textContent = formattedDate;
          })
      </script>
    </tbody>
  </table>

  <h2>Installation</h2>

  <p>
    Add the following script to your HTML file's <code>&lt;head&gt;</code> element:
  </p>

  <div id="installation"><script type="module" src="https://esm.sh/jsr/@celine/bibhtml@1.4.0"></script></div>

  <script id="installation-cell" type="module">
    celine.cell("installation", () => {
      return htl.html`<pre class='echo'>${document.getElementById('installation').innerHTML}</pre>`
    })
  </script>

  <h2>API</h2>

  <p>
    <cite>@celine/bibhtml</cite> is structured around 3 <a
      href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements">custom elements</a>:
    <ol>
      <li>
      <code>&lt;bh-cite&gt;</code>
      </li>
      <li>
      <code>&lt;bh-reference&gt;</code>
      </li>
      <li>
      <code>&lt;bh-bibliography&gt;</code>
      </li>
    </ol>
  </p>
  <br />

  <pre class="echo">
&lt;bh-cite&gt;willighagen2019&lt;/bh-cite&gt;
...
&lt;bh-reference id="willighagen2019"&gt;
  @article{willighagen2019,
  title = {Citation.js: a format-independent, modular bibliography tool for the browser and command line},
  author = {Willighagen, Lars G.},
  year = 2019,
  month = aug,
  keywords = {Bibliography, Javascript},
  volume = 5,
  pages = {e214},
  journal = {PeerJ Computer Science},
  issn = {2376-5992},
  url = {https://doi.org/10.7717/peerj-cs.214},
  doi = {10.7717/peerj-cs.214}
  }
&lt;/bh-reference&gt;
...
&lt;bh-bibliography format="apa"&gt;
&lt;/bh-bibliography&gt;</pre>

  <p>
    The <code>bh-</code> prefix was chosen to make the use of <code>&lt;bh-cite&gt;</code> relatively short.
  </p>

  <h3><code>&lt;bh-cite&gt;</code></h3>

  <p>
    To cite
    <span id="inner-text-container">Citation.js<sup><bh-cite><a href="#willighagen2019">[#?]</a></bh-cite></sup></span> as a reference,
    we can use the <code>&lt;bh-cite&gt;</code> element:
  </p>

  <script id="inner-text-cell" type="module">
    celine.cell("inner-text-cell", () => {
      const cloned = document.getElementById('inner-text-container').cloneNode(true);
      cloned.querySelector('bh-cite').removeAttribute('id');
      return htl.html`<pre class='echo'>${cloned.innerHTML}</pre>`
    })
  </script>

  <p>
    The <code>&lt;bh-cite&gt;</code> element:
    <ol>
      <li>Unhides the <code>&lt;bh-reference&gt;</code> targeted by the first inner <code>&lt;a&gt;</code> element, and adds a <a href="https://en.wikipedia.org/wiki/Backlink">backlink</a> to itself</li>
      <li>Replaces the first <code>#?</code><sup><a href="#a">(a)</a></sup> contained within the first inner <code>&lt;a&gt;</code> element with the reference number</li>
    </ol>
  </p>

  <p>
    This permits us to change the formatting of the inline citation, perhaps to use parentheses, like <span id="flex-1-container">like <sup><bh-cite><a href="#birolEtAl2013">(#?)</a></bh-cite></sup></span>.
  </p>

  <script id="flex-1-cell" type="module">
    celine.cell("flex-1-cell", () => {
      const cloned = document.getElementById('flex-1-container').cloneNode(true);
      cloned.querySelector('bh-cite').removeAttribute('id');
      return htl.html`<pre class='echo'>${cloned.innerHTML}</pre>`
    })
  </script>

  <p>
    We may choose to forgo number referencing entirely, <span id="flex-2-container">with (<bh-cite><a href="#birolEtAl2013">Birol et al.</a></bh-cite>, <a href="#birolEtAl2013">2013</a>)</span>
  </p>

  <script id="flex-2-cell" type="module">
    celine.cell("flex-2-cell", () => {
      const cloned = document.getElementById('flex-2-container').cloneNode(true);
      cloned.querySelector('bh-cite').removeAttribute('id');
      return htl.html`<pre class='echo'>${cloned.innerHTML}</pre>`
    })
  </script>

  <span id="flex-3-container">or <bh-cite><a href="#birolEtAl2013">Birol et al.</a></bh-cite> [<a href="#birolEtAl2013">2013</a>]</span>.

  <script id="flex-3-cell" type="module">
    celine.cell("flex-3-cell", () => {
      const cloned = document.getElementById('flex-3-container').cloneNode(true);
      cloned.querySelector('bh-cite').removeAttribute('id');
      return htl.html`<pre class='echo'>${cloned.innerHTML}</pre>`
    })
  </script>

  <p>
    If we cite a <span id="missing-container">missing reference<sup><bh-cite><a href="#freud2012">[#?]</a></bh-cite></sup></span> that is
    not in the HTML document, the inner text of the element is displayed unchanged.
  </p>

  <script id="missing-cell" type="module">
    celine.cell("missing-cell", () => {
      const cloned = document.getElementById('missing-container').cloneNode(true);
      cloned.querySelector('bh-cite').removeAttribute('id');
      return htl.html`<pre class='echo'>${cloned.innerHTML}</pre>`
    })
  </script>

  <p>
    The inner text of a <code>&lt;bh-cite&gt;</code> element is displayed unchanged when:

    <ul>
      <li>The cited reference ID does not correspond to a <code>&lt;bh-reference&gt;</code> element with a matching <code>id</code> attribute</li>
      <li>JavaScript is disabled</li>
      <li><cite>@celine/bibhtml</cite> fails to load or execute properly</li>
    </ul>
  </p>


  <h3><code>&lt;bh-reference&gt;</code></h3>

  <p>
    Each <code>&lt;bh-reference&gt;</code> must be tagged with an <code>id</code> attribute, and contain reference information in 4 supported formats:
  </p>

  <h4>BibTeX</h4>

  <script id="bibtex-cell" type="module">
    celine.cell("bibtex-cell", () => {
      const reference = document.getElementById('crichton2021nota');
      return htl.html`<pre class='echo'>${reference.outerHTML}</pre>`
    })
  </script>

  <p>
    This expands to reference <bh-cite><a href="#crichton2021nota">[#?]</a></bh-cite>, and is backed by <a href="https://www.npmjs.com/package/@citation-js/plugin-bibtex">@citation-js/plugin-bibtex</a>.
  </p>

  <h3>Unstructured text</h3>

  <p>
    A <code>&lt;bh-reference&gt;</code> can contain unstructured text. This format is useful when:
    <ul>
      <li>The reference is not in a machine readable format</li>
      <li>The reference is malformed</li>
      <li>The machine readable format is not supported by <cite>@celine/bibhtml</cite> or Citation.js</li>
    </ul>
  </p>

  <script id="text-cell" type="module">
    celine.cell("text-cell", () => {
      const reference = document.getElementById('dunbar2017');
      return htl.html`<pre class='echo'>${reference.outerHTML}</pre>`
    })
  </script>

  <p>
    Observe that the reference <bh-cite><a href="#dunbar2017">[#?]</a></bh-cite> is unchanged.
  </p>

  <h4>DOI</h4>

  <script id="doi-cell" type="module">
    celine.cell("doi-cell", () => {
      const reference = document.getElementById('slivaLambert2015');
      return htl.html`<pre class='echo'>${reference.outerHTML}</pre>`
    })
  </script>

  <p>
    This expands to reference <bh-cite><a href="#slivaLambert2015">[#?]</a></bh-cite>, and is backed by <a href="https://www.npmjs.com/package/@citation-js/plugin-doi">@citation-js/plugin-doi</a>.
  </p>

  <h4>Wikidata</h4>

  <script id="wikidata-cell" type="module">
    celine.cell("wikidata-cell", () => {
      const reference = document.getElementById('birolEtAl2013');
      return htl.html`<pre class='echo'>${reference.outerHTML}</pre>`
    })
  </script>

  <p>
    This expands to reference <bh-cite><a href="#birolEtAl2013">[#?]</a></bh-cite>, and is backed by <a href="https://www.npmjs.com/package/@citation-js/plugin-wikidata">@citation-js/plugin-wikidata</a>.
  </p>

  <h3><code>&lt;bh-bibliography&gt;</code></h3>

  <p>
    The <code>&lt;bh-bibliography&gt;</code> finds <code>&lt;bh-reference&gt;</code>s and renders them in a formatted list (like at the <a href="#references">bottom of the page</a>). 
  </p>
  <p>
    <code>&lt;/bh-bibliography&gt;</code> has very simple calling semantics. Just:
  </p>
  <br />

  <pre class="echo">
&lt;bh-bibliography format="apa"&gt;
&lt;/bh-bibliography&gt;</pre>

  <p style="border: 1px solid orange; background-color: #fff8e1; border-radius: 8px; padding: 10px; margin: 10px;">
    Do not put <code>&lt;bh-reference&gt;</code> elements inside the <code>&lt;bh-bibliography&gt;</code> element. Everything will break.
  </p>

    <p>The <code>format</code> attribute sets the citation style. Currently only 1 is supported, <code>"apa"</code>.</p>
    <p>References are rendered in the order they are cited by <code>&lt;bh-cite&gt;</code> elements, <i>not</i> the order they are declared in the HTML document.</p>

  <h2>Extras</h2>

  <p>
    <code>&lt;bh-cite&gt;</code> has an appropriate implementation of <code>disconnectedCallback</code> to remove the citation from the bibliography when the <code>&lt;bh-cite&gt;</code> element is removed from the DOM.
  </p>

<script id="viewof toggle-citation" type="module">
  celine.viewof('toggle-citation', () => {
    return Inputs.toggle({
      label: 'Toggle citation',
      value: true
    });
  });
</script>

<script id="dynamic-citation" type="module" contenteditable="true">
  celine.cell('dynamic-citation', ['toggle-citation'], (toggleCitation) => {
  return toggleCitation 
      ? htl.html`<bh-cite><a href="#griesemer2020featherweight">[#?]</bh-cite>` 
      : htl.html`<i>CITATION GONE</i>`;
  });
</script>

  <h2 id="references">References</h2>


<bh-reference id="willighagen2019">
  @article{willighagen2019,
  title = {Citation.js: a format-independent, modular bibliography tool for the browser and command line},
  author = {Willighagen, Lars G.},
  year = 2019,
  month = aug,
  keywords = {Bibliography, Javascript},
  volume = 5,
  pages = {e214},
  journal = {PeerJ Computer Science},
  issn = {2376-5992},
  url = {https://doi.org/10.7717/peerj-cs.214},
  doi = {10.7717/peerj-cs.214}
  }
</bh-reference>
<bh-reference id="avellar2021">
  @misc{avellar2021,
  author = {Matheus Avellar},
  title = {References Web Component},
  howpublished = {\url{https://lab.avl.la/references-webcomponent/}},
  note = {GitHub: \url{https://github.com/MatheusAvellar/references-webcomponent}},
  year = {2021},
  month = aug,
  }
</bh-reference>
<bh-reference id="crichton2021nota">
  @inproceedings{crichton2021nota,
  title={A New Medium for Communicating Research on Programming Languages},
  author={Crichton, Will},
  booktitle={Proceedings of the 1st Workshop on Human Aspects of Types and Reasoning Assistants},
  year={2021}
  }
</bh-reference>
<bh-reference id="dunbar2017">
  Brian Dunbar (2017-08-03). The Sun | NASA. National Aeronautics and Space Administration. 
  Accessed on 2021-08-30.
</bh-reference>
<bh-reference id="slivaLambert2015">
  10.1080/15588742.2015.1017687
</bh-reference>
<bh-reference id="birolEtAl2013">
  Q21972834
</bh-reference>
<bh-reference id="griesemer2020featherweight">
  @misc{griesemer2020featherweight,
    title={Featherweight Go}, 
    author={Robert Griesemer and Raymond Hu and Wen Kokke and Julien Lange and Ian Lance Taylor and Bernardo Toninho and Philip Wadler and Nobuko Yoshida},
    year={2020},
    eprint={2005.11710},
    archivePrefix={arXiv},
    primaryClass={cs.PL},
    url={https://arxiv.org/abs/2005.11710}, 
}
</bh-reference>

<bh-bibliography format="apa">
</bh-bibliography>


<h2>Footnotes</h2>


<ol type="a">
  <li id="a">
    I considered replacing just <code>?</code>, rather than <code>#?</code>, but I worried that this would cause replacement of <code>?</code>s appended to the end of uncertain dates, like <code>2017?</code>.
  </li>
</ol>


</main>
</body>
</html>
