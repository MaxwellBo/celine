<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@celine/celine</title>

  <!-- <link rel="preconnect" href="https://rsms.me/">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css"> -->

  <link rel="stylesheet" href="reset.css" />
  <link rel="stylesheet" href="index.css" />

  <style>
    script.echo::before {
      content: "<script type=\"" attr(type) "\" class=\"" attr(class) "\" id=\"" attr(id) "\" contenteditable=\"" attr(contenteditable) "\">";
    }

    script.echo::after {
      content: "<\/script>";
    }

    style.echo::before {
      content: "<style class=\"" attr(class) "\" contenteditable=\"" attr(contenteditable) "\">";
    }

    style.echo::after {
      content: "<\/style>";
    }

    /*
      Josh's Custom CSS Reset
      https://www.joshwcomeau.com/css/custom-css-reset/
    */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    * {
      margin: 0;
    }
    html, body {
      height: 100%;
    }
    body {
      -webkit-font-smoothing: antialiased;
    }
    img, picture, video, canvas, svg {
      display: block;
      max-width: 100%;
    }
    input, button, textarea, select {
      font: inherit;
    }
    #root, #__next {
      isolation: isolate;
    }
  </style>
</head>

<body>
<table class="header">
  <tbody>
    <tr>
    <th colspan="4" rowspan="2" class="width-auto">
      <h1 class="title">@celine/celine</h1>
      <span class="subtitle">A microlibrary for building reactive HTML notebooks</span>
    </th>
  </tr>
  <tr>
  </tr>
  <tr>
    <th class="width-min">Author</th>
    <td class="width-auto"><a href="https://maxbo.me"><cite>Max Bo</cite></a></td>
    <th>Updated</th>
    <td class="width-min"><time style="white-space: pre;">2024-09-18</time></td>
  </tr>
  <tr>
    <th>GitHub</th>
    <td class="width-auto"><a href="https://github.com/MaxwellBo/celine">MaxwellBo/<wbr>celine</a></td>
    <th class="width-min">License</th>
    <td>MIT</td>
  </tr>
  <tr>
    <th>JSR</th>
    <td class="width-auto"><a href="https://jsr.io/@celine/celine">jsr.io/<wbr>@celine/<wbr>celine</a></td>
    <th>Version</th>
    <td class="width-min">v0.1.7</td>
  </tr>
</tbody></table>
<main>
<p><code>@celine/celine</code> is the library I promised everyone I'd release after I published <a href="https://maxbo.me/a-html-file-is-all-you-need.html"><q>Reactive HTML notebooks (2024)</q></a>.</p>

<p>It wraps a subset of the <a href="https://observablehq.com/documentation/notebooks/">Observable Notebook</a> <a href="https://github.com/observablehq/runtime">runtime</a> to provide a minimal (and opinionated) API for notebook construction.</p>

<h2>Installation</h2>

<p>Add the following <code>script</code> and <code>style</code> elements to your HTML file:</p>

<style class="echo">
/* https://blog.glyphdrawing.club/font-with-built-in-syntax-highlighting/ */
@font-face {
  font-family: 'FontWithASyntaxHighlighter';
  src:
    url('https://maxbo.me/celine/FontWithASyntaxHighlighter-Regular.woff2') format('woff2');
}

.echo {
  display: block;
  overflow: auto;
  font-family: "FontWithASyntaxHighlighter", monospace;
  font-feature-settings: "colr", "calt";
  white-space: pre;
  color: #eee;
  background-color: #222;
}

.observablehq {
  margin-top: 1rem;
}

@keyframes blink {
  67% {
    opacity: 0;
  }
}
.observablehq--running::before {
  content: 'LOADING';
  animation: blink 1s step-end infinite;
}

.observablehq--error {
  color: #d00;
}
</style>

<br />

<script type="module" class="echo">
import { CelineModule, reevaluateOnBlur } from 'https://esm.sh/jsr/@celine/celine@0.1.7';
import * as Inputs from 'https://esm.run/@observablehq/inputs@0.12.0';
import * as htl from 'https://esm.run/htl@0.3.1';

window.celine = CelineModule.usingNewObservableRuntime(document);
window.library = celine.library;
window.Inputs = Inputs;
window.htl = htl;

reevaluateOnBlur(document, 'echo');
</script>

<h2>Usage</h2>

<i>All of the following <code>script</code>s are <code>contenteditable</code> and reevaluate on blur.</i>

<h3><code>cell</code>s</h3>

<script type="module" class="echo" id="counter" contenteditable="true">
celine.cell("counter", async function* () {
  let i = 0;
  while (true) {
    await library.Promises.delay(1000);
    yield i++;
  }
});
</script>

<script type="module" class="echo" id="fizzbuzz" contenteditable="true">
celine.cell("fizzbuzz", ["counter"], (counter) => {
  if (counter % 3 === 0 && counter % 5 === 0) {
    return htl.html`<b style="color: purple">FizzBuzz</b>`;
  } else if (counter % 3 === 0) {
    return htl.html`<b style="color: red">Fizz</b>`;
  } else if (counter % 5 === 0) {
    return htl.html`<b style="color: blue">Buzz</b>`;
  } else {
    return htl.html`<b>${counter}</b>`;
  }
});
</script>


<h3><code>viewof</code>s</h3>

<script type="module" class="echo" id="viewof name" contenteditable="true">
celine.viewof("name", () => {
  return Inputs.text({placeholder: "What's your name?"});
});
</script>

<script type="module" class="echo" id="greeting" contenteditable="true">
celine.cell("greeting", ["name"], (name) => {
  return htl.html`Hello, <b>${name}</b>!`;
});
</script>

<h3><code>mutable</code>s</h3>

<script type="module" class="echo" id="ref" contenteditable="true">
window.ref = celine.mutable("ref", 3)
</script>


<script type="module" class="echo" id="viewof increment" contenteditable="true">
celine.viewof("increment", () => {
  const increment = () => ++ref.value;
  const reset = () => ref.value = 0;

  return Inputs.button([["Increment", increment], ["Reset", reset]]);
});
</script>

<script type="module" class="echo" id="sword" contenteditable="true">
celine.cell("sword", ["ref"], (ref) => {
  return htl.html`↜(╰ •ω•)╯ |${'═'.repeat(ref)}═ﺤ`
});
</script>

</main>
</body>
</html>